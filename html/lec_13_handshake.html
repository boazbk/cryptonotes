<!DOCTYPE html>
<html  lang="en">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>An intensive introduction to cryptography: </title>
  <meta name="description" content="Lecture notes on Cryptography by Boaz Barak">

  <meta property="og:title" content="An intensive introduction to cryptography: " />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://intensecrypto.org/" />
  <meta property="og:image" content="icons/cover.png" />
  <meta property="og:description" content="Lecture notes on Cryptography by Boaz Barak" />
  <meta name="github-repo" content="boazbk/crypto" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="An intensive introduction to cryptography" />
  <meta name="twitter:description" content="Lecture notes on Cryptography by Boaz Barak" />
  <meta name="twitter:image" content="https://intensecrypto.org/icons/cover.png" />

<meta name="author" content="Boaz Barak">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="icons/apple-touch-icon-120x120.png">
  <link rel="shortcut icon" href="icons/favicon.ico" type="image/x-icon">

<!-- Boaz: resources -->

<!-- <script src="https://kit.fontawesome.com/ab08ce82a8.js"></script> -->

<link rel="stylesheet" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css">


<!-- KaTeX -->


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css"
  integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">

<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"
  integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>

<!-- To automatically render math in text elements, include the auto-render extension: -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js"
  integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
  onload='renderMathInElement(document.body, {  throwOnError: false, macros: { "\\N": "\\mathbb{N}", "\\R": "\\mathbb{R}", "\\Z": "\\mathbb{Z}","\\E": "\\mathbb{E}","\\val": "\\mathrm{val}", "\\label": "\\;\\;\\;\\;\\;\\;\\;\\;","\\floor": "\\lfloor #1 \\rfloor","\\ceil": "\\lceil #1 \\rceil", "\\ensuremath": "#1"}});'>
</script>




<!-- KaTeX -->
<!-- pseudocode -->
<link rel="stylesheet" href="css/pseudocode.css">
<!-- <script src="js/pseudocode.min.js"></script> -->


<!-- Gitbook resources -->

  <script src="js/jquery.min.js"></script>
  <link href="css/style.css" rel="stylesheet" />
  
  <link href="css/plugin-table.css" rel="stylesheet" />
  <link href="css/plugin-bookdown.css" rel="stylesheet" />
  <link href="css/plugin-highlight.css" rel="stylesheet" />
  <link href="css/plugin-search.css" rel="stylesheet" />
  <link href="css/plugin-fontsettings.css" rel="stylesheet" />
  <link href="css/moregitbook.css" rel="stylesheet" />

  <link href="css/resmisc.css" rel="stylesheet" />





<!-- Boaz: end resources -->



<!--bookdown:link_prev-->
<!--bookdown:link_next-->




<!-- bigfoot-->

<link href="css/bigfoot-default.css" rel="stylesheet" />
<script type="text/javascript" src="js/bigfoot.js"></script>

<script type="text/javascript">
    var bigfoot = jQuery.bigfoot(
        {
            deleteOnUnhover: false,
            preventPageScroll: false,
            hoverDelay: 250
        }
    );
</script>

<!-- end bigfoot -->


</head>

<body>



<!--bookdown:title:start-->
<!--bookdown:title:end-->


<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul class="summary">
<li><a href="./">An intensive introduction to cryptography</a></li>
<li class="divider"></li><li class="chapter" data-level="p" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>p</b> Foreword and Syllabus</a><ul><li class="chapter" data-level="p.1" data-path=".html"><a href=".html#syllabus"><i class="fa fa-check"></i><b>p.1</b> Syllabus</a><ul><li class="chapter" data-level="p.1.1" data-path=".html"><a href=".html#prerequisites"><i class="fa fa-check"></i><b>p.1.1</b> Prerequisites</a></li></ul></li><li class="chapter" data-level="p.2" data-path=".html"><a href=".html#why-is-cryptography-hard"><i class="fa fa-check"></i><b>p.2</b> Why is cryptography hard?</a></li></ul></li><li class="chapter" data-level="0" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>0</b> Mathematical Background</a><ul><li class="chapter" data-level="0.1" data-path=".html"><a href=".html#a-quick-overview-of-mathematical-prerequisites"><i class="fa fa-check"></i><b>0.1</b> A quick overview of mathematical prerequisites</a></li><li class="chapter" data-level="0.2" data-path=".html"><a href=".html#mathematical-proofs"><i class="fa fa-check"></i><b>0.2</b> Mathematical Proofs</a><ul><li class="chapter" data-level="0.2.1" data-path=".html"><a href=".html#example-the-existence-of-infinitely-many-primes."><i class="fa fa-check"></i><b>0.2.1</b> Example: The existence of infinitely many primes.</a></li></ul></li><li class="chapter" data-level="0.3" data-path=".html"><a href=".html#probability-and-sample-spaces"><i class="fa fa-check"></i><b>0.3</b> Probability and Sample spaces</a><ul><li class="chapter" data-level="0.3.1" data-path=".html"><a href=".html#random-variables"><i class="fa fa-check"></i><b>0.3.1</b> Random variables</a></li><li class="chapter" data-level="0.3.2" data-path=".html"><a href=".html#distributions-over-strings"><i class="fa fa-check"></i><b>0.3.2</b> Distributions over strings</a></li><li class="chapter" data-level="0.3.3" data-path=".html"><a href=".html#more-general-sample-spaces."><i class="fa fa-check"></i><b>0.3.3</b> More general sample spaces.</a></li></ul></li><li class="chapter" data-level="0.4" data-path=".html"><a href=".html#correlations-and-independence"><i class="fa fa-check"></i><b>0.4</b> Correlations and independence</a><ul><li class="chapter" data-level="0.4.1" data-path=".html"><a href=".html#independent-random-variables"><i class="fa fa-check"></i><b>0.4.1</b> Independent random variables</a></li><li class="chapter" data-level="0.4.2" data-path=".html"><a href=".html#collections-of-independent-random-variables."><i class="fa fa-check"></i><b>0.4.2</b> Collections of independent random variables.</a></li></ul></li><li class="chapter" data-level="0.5" data-path=".html"><a href=".html#concentration-and-tail-bounds"><i class="fa fa-check"></i><b>0.5</b> Concentration and tail bounds</a><ul><li class="chapter" data-level="0.5.1" data-path=".html"><a href=".html#chebyshevs-inequality"><i class="fa fa-check"></i><b>0.5.1</b> Chebyshev’s Inequality</a></li><li class="chapter" data-level="0.5.2" data-path=".html"><a href=".html#the-chernoff-bound"><i class="fa fa-check"></i><b>0.5.2</b> The Chernoff bound</a></li></ul></li><li class="chapter" data-level="0.6" data-path=".html"><a href=".html#exercises"><i class="fa fa-check"></i><b>0.6</b> Exercises</a></li><li class="chapter" data-level="0.7" data-path=".html"><a href=".html#exercises-1"><i class="fa fa-check"></i><b>0.7</b> Exercises</a></li></ul></li><li class="chapter" data-level="1" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul><li class="chapter" data-level="1.1" data-path=".html"><a href=".html#some-history"><i class="fa fa-check"></i><b>1.1</b> Some history</a></li><li class="chapter" data-level="1.2" data-path=".html"><a href=".html#defining-encryptions"><i class="fa fa-check"></i><b>1.2</b> Defining encryptions</a></li><li class="chapter" data-level="1.3" data-path=".html"><a href=".html#defining-security-of-encryption"><i class="fa fa-check"></i><b>1.3</b> Defining security of encryption</a><ul><li class="chapter" data-level="1.3.1" data-path=".html"><a href=".html#generating-randomness-in-actual-cryptographic-systems"><i class="fa fa-check"></i><b>1.3.1</b> Generating randomness in actual cryptographic systems</a></li></ul></li><li class="chapter" data-level="1.4" data-path=".html"><a href=".html#defining-the-secrecy-requirement."><i class="fa fa-check"></i><b>1.4</b> Defining the secrecy requirement.</a></li><li class="chapter" data-level="1.5" data-path=".html"><a href=".html#perfect-secrecy"><i class="fa fa-check"></i><b>1.5</b> Perfect Secrecy</a><ul><li class="chapter" data-level="1.5.1" data-path=".html"><a href=".html#achieving-perfect-secrecy"><i class="fa fa-check"></i><b>1.5.1</b> Achieving perfect secrecy</a></li></ul></li><li class="chapter" data-level="1.6" data-path=".html"><a href=".html#necessity-of-long-keys"><i class="fa fa-check"></i><b>1.6</b> Necessity of long keys</a><ul><li class="chapter" data-level="1.6.1" data-path=".html"><a href=".html#amplifying-success-probability"><i class="fa fa-check"></i><b>1.6.1</b> Amplifying success probability</a></li></ul></li><li class="chapter" data-level="1.7" data-path=".html"><a href=".html#bibliographical-notes"><i class="fa fa-check"></i><b>1.7</b> Bibliographical notes</a></li></ul></li><li class="chapter" data-level="2" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>2</b> Computational Security</a><ul><li><ul><li class="chapter" data-level="2.0.1" data-path=".html"><a href=".html#proof-by-reduction"><i class="fa fa-check"></i><b>2.0.1</b> Proof by reduction</a></li></ul></li><li class="chapter" data-level="2.1" data-path=".html"><a href=".html#the-asymptotic-approach"><i class="fa fa-check"></i><b>2.1</b> The asymptotic approach</a><ul><li class="chapter" data-level="2.1.1" data-path=".html"><a href=".html#countoperation"><i class="fa fa-check"></i><b>2.1.1</b> Counting number of operations.</a></li></ul></li><li class="chapter" data-level="2.2" data-path=".html"><a href=".html#our-first-conjecture"><i class="fa fa-check"></i><b>2.2</b> Our first conjecture</a></li><li class="chapter" data-level="2.3" data-path=".html"><a href=".html#why-care-about-the-cipher-conjecture"><i class="fa fa-check"></i><b>2.3</b> Why care about the cipher conjecture?</a></li><li class="chapter" data-level="2.4" data-path=".html"><a href=".html#prelude-computational-indistinguishability"><i class="fa fa-check"></i><b>2.4</b> Prelude: Computational Indistinguishability</a></li><li class="chapter" data-level="2.5" data-path=".html"><a href=".html#the-length-extension-theorem"><i class="fa fa-check"></i><b>2.5</b> The Length Extension Theorem</a><ul><li class="chapter" data-level="2.5.1" data-path=".html"><a href=".html#appendix-the-computational-model"><i class="fa fa-check"></i><b>2.5.1</b> Appendix: The computational model</a></li></ul></li></ul></li><li class="chapter" data-level="3" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>3</b> Pseudorandomness</a><ul><li><ul><li class="chapter" data-level="3.0.1" data-path=".html"><a href=".html#unpredictability-an-alternative-approach-for-proving-the-length-extension-theorem"><i class="fa fa-check"></i><b>3.0.1</b> Unpredictability: an alternative approach for proving the length extension theorem</a></li></ul></li><li class="chapter" data-level="3.1" data-path=".html"><a href=".html#stream-ciphers"><i class="fa fa-check"></i><b>3.1</b> Stream ciphers</a></li><li class="chapter" data-level="3.2" data-path=".html"><a href=".html#what-do-pseudorandom-generators-actually-look-like"><i class="fa fa-check"></i><b>3.2</b> What do pseudorandom generators actually look like?</a><ul><li class="chapter" data-level="3.2.1" data-path=".html"><a href=".html#attempt-0-the-counter-generator"><i class="fa fa-check"></i><b>3.2.1</b> Attempt 0: The counter generator</a></li><li class="chapter" data-level="3.2.2" data-path=".html"><a href=".html#attempt-1-the-linear-checksum-linear-feedback-shift-register-lfsr"><i class="fa fa-check"></i><b>3.2.2</b> Attempt 1: The linear checksum / linear feedback shift register (LFSR)</a></li><li class="chapter" data-level="3.2.3" data-path=".html"><a href=".html#from-insecurity-to-security"><i class="fa fa-check"></i><b>3.2.3</b> From insecurity to security</a></li><li class="chapter" data-level="3.2.4" data-path=".html"><a href=".html#attempt-2-linear-congruential-generators-with-dropped-bits"><i class="fa fa-check"></i><b>3.2.4</b> Attempt 2: Linear Congruential Generators with dropped bits</a></li></ul></li><li class="chapter" data-level="3.3" data-path=".html"><a href=".html#successful-examples"><i class="fa fa-check"></i><b>3.3</b> Successful examples</a><ul><li class="chapter" data-level="3.3.1" data-path=".html"><a href=".html#case-study-1-subset-sum-generator"><i class="fa fa-check"></i><b>3.3.1</b> Case Study 1: Subset Sum Generator</a></li><li class="chapter" data-level="3.3.2" data-path=".html"><a href=".html#case-study-2-rc4"><i class="fa fa-check"></i><b>3.3.2</b> Case Study 2: RC4</a></li></ul></li><li class="chapter" data-level="3.4" data-path=".html"><a href=".html#case-study-3-b.b.s."><i class="fa fa-check"></i><b>3.4</b> Case Study 3: B.B.S.</a></li><li class="chapter" data-level="3.5" data-path=".html"><a href=".html#non-constructive-existence-of-pseudorandom-generators"><i class="fa fa-check"></i><b>3.5</b> Non-constructive existence of pseudorandom generators</a></li></ul></li><li class="chapter" data-level="4" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>4</b> Pseudorandom functions</a><ul><li class="chapter" data-level="4.1" data-path=".html"><a href=".html#one-time-passwords-e.g.-google-authenticator-rsa-id-etc."><i class="fa fa-check"></i><b>4.1</b> One time passwords (e.g. Google Authenticator, RSA ID, etc.)</a><ul><li class="chapter" data-level="4.1.1" data-path=".html"><a href=".html#how-do-pseudorandom-functions-help-in-the-login-problem"><i class="fa fa-check"></i><b>4.1.1</b> How do pseudorandom functions help in the login problem?</a></li></ul></li><li class="chapter" data-level="4.2" data-path=".html"><a href=".html#message-authentication-codes"><i class="fa fa-check"></i><b>4.2</b> Message Authentication Codes</a></li><li class="chapter" data-level="4.3" data-path=".html"><a href=".html#macs-from-prfs"><i class="fa fa-check"></i><b>4.3</b> MACs from PRFs</a></li><li class="chapter" data-level="4.4" data-path=".html"><a href=".html#input-length-extension-for-macs-and-prfs"><i class="fa fa-check"></i><b>4.4</b> Input length extension for MACs and PRFs</a></li><li class="chapter" data-level="4.5" data-path=".html"><a href=".html#aside-natural-proofs"><i class="fa fa-check"></i><b>4.5</b> Aside: natural proofs</a></li></ul></li><li class="chapter" data-level="5" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>5</b> Pseudorandom functions from pseudorandom generators</a><ul><li class="chapter" data-level="5.1" data-path=".html"><a href=".html#securely-encrypting-many-messages---chosen-plaintext-security"><i class="fa fa-check"></i><b>5.1</b> Securely encrypting many messages - chosen plaintext security</a></li><li class="chapter" data-level="5.2" data-path=".html"><a href=".html#pseudorandom-permutations-block-ciphers"><i class="fa fa-check"></i><b>5.2</b> Pseudorandom permutations / block ciphers</a></li><li class="chapter" data-level="5.3" data-path=".html"><a href=".html#encryption-modes"><i class="fa fa-check"></i><b>5.3</b> Encryption modes</a></li><li class="chapter" data-level="5.4" data-path=".html"><a href=".html#optional-aside-broadcast-encryption"><i class="fa fa-check"></i><b>5.4</b> Optional, Aside: Broadcast Encryption</a></li></ul></li><li class="chapter" data-level="6" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>6</b> Chosen Ciphertext Security</a><ul><li class="chapter" data-level="6.1" data-path=".html"><a href=".html#short-recap"><i class="fa fa-check"></i><b>6.1</b> Short recap</a></li><li class="chapter" data-level="6.2" data-path=".html"><a href=".html#going-beyond-cpa"><i class="fa fa-check"></i><b>6.2</b> Going beyond CPA</a><ul><li class="chapter" data-level="6.2.1" data-path=".html"><a href=".html#example-the-wired-equivalence-protocol-wep"><i class="fa fa-check"></i><b>6.2.1</b> Example: The Wired Equivalence Protocol (WEP)</a></li><li class="chapter" data-level="6.2.2" data-path=".html"><a href=".html#chosen-ciphertext-security-1"><i class="fa fa-check"></i><b>6.2.2</b> Chosen ciphertext security</a></li></ul></li><li class="chapter" data-level="6.3" data-path=".html"><a href=".html#constructing-cca-secure-encryption"><i class="fa fa-check"></i><b>6.3</b> Constructing CCA secure encryption</a></li><li class="chapter" data-level="6.4" data-path=".html"><a href=".html#simplified-gcm-encryption"><i class="fa fa-check"></i><b>6.4</b> (Simplified) GCM encryption</a></li><li class="chapter" data-level="6.5" data-path=".html"><a href=".html#padding-chopping-and-their-pitfalls-the-buffer-overflow-of-cryptography"><i class="fa fa-check"></i><b>6.5</b> Padding, chopping, and their pitfalls: the "buffer overflow" of cryptography</a></li><li class="chapter" data-level="6.6" data-path=".html"><a href=".html#chosen-ciphertext-attack-as-implementing-metaphors"><i class="fa fa-check"></i><b>6.6</b> Chosen ciphertext attack as implementing metaphors</a></li></ul></li><li class="chapter" data-level="7" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>7</b> Hash Functions and Random Oracles</a><ul><li class="chapter" data-level="7.1" data-path=".html"><a href=".html#the-bitcoin-problem"><i class="fa fa-check"></i><b>7.1</b> The "Bitcoin" Problem</a><ul><li class="chapter" data-level="7.1.1" data-path=".html"><a href=".html#the-currency-problem"><i class="fa fa-check"></i><b>7.1.1</b> The Currency Problem</a></li><li class="chapter" data-level="7.1.2" data-path=".html"><a href=".html#bitcoin-architecture"><i class="fa fa-check"></i><b>7.1.2</b> Bitcoin Architecture</a></li></ul></li><li class="chapter" data-level="7.2" data-path=".html"><a href=".html#the-bitcoin-ledger"><i class="fa fa-check"></i><b>7.2</b> The Bitcoin Ledger</a><ul><li class="chapter" data-level="7.2.1" data-path=".html"><a href=".html#from-proof-of-work-to-consensus-on-ledger"><i class="fa fa-check"></i><b>7.2.1</b> From Proof of Work to Consensus on Ledger</a></li></ul></li><li class="chapter" data-level="7.3" data-path=".html"><a href=".html#collision-resistance-hash-functions-and-creating-short-unique-identifiers"><i class="fa fa-check"></i><b>7.3</b> Collision Resistance Hash Functions and Creating Short "Unique" Identifiers</a></li><li class="chapter" data-level="7.4" data-path=".html"><a href=".html#practical-constructions-of-cryptographic-hash-functions"><i class="fa fa-check"></i><b>7.4</b> Practical Constructions of Cryptographic Hash Functions</a><ul><li class="chapter" data-level="7.4.1" data-path=".html"><a href=".html#practical-random-ish-functions"><i class="fa fa-check"></i><b>7.4.1</b> Practical Random-ish Functions</a></li><li class="chapter" data-level="7.4.2" data-path=".html"><a href=".html#some-history"><i class="fa fa-check"></i><b>7.4.2</b> Some History</a></li><li class="chapter" data-level="7.4.3" data-path=".html"><a href=".html#the-nsa-and-hash-functions"><i class="fa fa-check"></i><b>7.4.3</b> The NSA and Hash Functions</a></li><li class="chapter" data-level="7.4.4" data-path=".html"><a href=".html#cryptographic-vs-non-cryptographic-hash-functions"><i class="fa fa-check"></i><b>7.4.4</b> Cryptographic vs Non-Cryptographic Hash Functions</a></li></ul></li></ul></li><li class="chapter" data-level="8" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>8</b> Key derivation, protecting passwords, slow hashes, Merkle trees</a><ul><li class="chapter" data-level="8.1" data-path=".html"><a href=".html#keys-from-passwords"><i class="fa fa-check"></i><b>8.1</b> Keys from passwords</a></li><li class="chapter" data-level="8.2" data-path=".html"><a href=".html#merkle-trees-and-verifying-storage."><i class="fa fa-check"></i><b>8.2</b> Merkle trees and verifying storage.</a></li><li class="chapter" data-level="8.3" data-path=".html"><a href=".html#proofs-of-retrievability"><i class="fa fa-check"></i><b>8.3</b> Proofs of Retrievability</a></li><li class="chapter" data-level="8.4" data-path=".html"><a href=".html#entropy-extraction"><i class="fa fa-check"></i><b>8.4</b> Entropy extraction</a><ul><li class="chapter" data-level="8.4.1" data-path=".html"><a href=".html#forward-and-backward-secrecy"><i class="fa fa-check"></i><b>8.4.1</b> Forward and backward secrecy</a></li></ul></li></ul></li><li class="chapter" data-level="9" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>9</b> Private key crypto recap</a><ul><li><ul><li class="chapter" data-level="9.0.1" data-path=".html"><a href=".html#attacks-on-private-key-cryptosystems"><i class="fa fa-check"></i><b>9.0.1</b> Attacks on private key cryptosystems</a></li></ul></li></ul></li><li class="chapter" data-level="10" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>10</b> Public key cryptography</a><ul><li class="chapter" data-level="10.1" data-path=".html"><a href=".html#private-key-crypto-recap"><i class="fa fa-check"></i><b>10.1</b> Private key crypto recap</a></li><li class="chapter" data-level="10.2" data-path=".html"><a href=".html#public-key-encryptions-definition"><i class="fa fa-check"></i><b>10.2</b> Public Key Encryptions: Definition</a><ul><li class="chapter" data-level="10.2.1" data-path=".html"><a href=".html#the-obfuscation-paradigm"><i class="fa fa-check"></i><b>10.2.1</b> The obfuscation paradigm</a></li></ul></li><li class="chapter" data-level="10.3" data-path=".html"><a href=".html#some-concrete-candidates"><i class="fa fa-check"></i><b>10.3</b> Some concrete candidates:</a><ul><li class="chapter" data-level="10.3.1" data-path=".html"><a href=".html#diffie-hellman-encryption-aka-el-gamal"><i class="fa fa-check"></i><b>10.3.1</b> Diffie-Hellman Encryption (aka El-Gamal)</a></li><li class="chapter" data-level="10.3.2" data-path=".html"><a href=".html#sampling-random-primes"><i class="fa fa-check"></i><b>10.3.2</b> Sampling random primes</a></li><li class="chapter" data-level="10.3.3" data-path=".html"><a href=".html#a-little-bit-of-group-theory."><i class="fa fa-check"></i><b>10.3.3</b> A little bit of group theory.</a></li><li class="chapter" data-level="10.3.4" data-path=".html"><a href=".html#digital-signatures"><i class="fa fa-check"></i><b>10.3.4</b> Digital Signatures</a></li><li class="chapter" data-level="10.3.5" data-path=".html"><a href=".html#the-digital-signature-algorithm-dsa"><i class="fa fa-check"></i><b>10.3.5</b> The Digital Signature Algorithm (DSA)</a></li></ul></li><li class="chapter" data-level="10.4" data-path=".html"><a href=".html#putting-everything-together---security-in-practice."><i class="fa fa-check"></i><b>10.4</b> Putting everything together - security in practice.</a></li><li class="chapter" data-level="10.5" data-path=".html"><a href=".html#appendix-an-alternative-proof-of-the-density-of-primes"><i class="fa fa-check"></i><b>10.5</b> Appendix: An alternative proof of the density of primes</a></li><li class="chapter" data-level="10.6" data-path=".html"><a href=".html#additional-group-theory-exercises-and-proofs"><i class="fa fa-check"></i><b>10.6</b> Additional Group Theory Exercises and Proofs</a><ul><li class="chapter" data-level="10.6.1" data-path=".html"><a href=".html#solved-exercises"><i class="fa fa-check"></i><b>10.6.1</b> Solved exercises:</a></li></ul></li></ul></li><li class="chapter" data-level="11" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>11</b> Concrete candidates for public key crypto</a><ul><li class="chapter" data-level="11.1" data-path=".html"><a href=".html#some-number-theory."><i class="fa fa-check"></i><b>11.1</b> Some number theory.</a><ul><li class="chapter" data-level="11.1.1" data-path=".html"><a href=".html#primaliy-testing"><i class="fa fa-check"></i><b>11.1.1</b> Primaliy testing</a></li><li class="chapter" data-level="11.1.2" data-path=".html"><a href=".html#fields"><i class="fa fa-check"></i><b>11.1.2</b> Fields</a></li><li class="chapter" data-level="11.1.3" data-path=".html"><a href=".html#chinese-remainder-theorem"><i class="fa fa-check"></i><b>11.1.3</b> Chinese remainder theorem</a></li><li class="chapter" data-level="11.1.4" data-path=".html"><a href=".html#the-rsa-and-rabin-functions"><i class="fa fa-check"></i><b>11.1.4</b> The RSA and Rabin functions</a></li><li class="chapter" data-level="11.1.5" data-path=".html"><a href=".html#abstraction-trapdoor-permutations"><i class="fa fa-check"></i><b>11.1.5</b> Abstraction: trapdoor permutations</a></li><li class="chapter" data-level="11.1.6" data-path=".html"><a href=".html#public-key-encryption-from-trapdoor-permutations"><i class="fa fa-check"></i><b>11.1.6</b> Public key encryption from trapdoor permutations</a></li><li class="chapter" data-level="11.1.7" data-path=".html"><a href=".html#digital-signatures-from-trapdoor-permutations"><i class="fa fa-check"></i><b>11.1.7</b> Digital signatures from trapdoor permutations</a></li></ul></li><li class="chapter" data-level="11.2" data-path=".html"><a href=".html#hardcore-bits-and-security-without-random-oracles"><i class="fa fa-check"></i><b>11.2</b> Hardcore bits and security without random oracles</a><ul><li class="chapter" data-level="11.2.1" data-path=".html"><a href=".html#extending-to-more-than-one-hardcore-bit"><i class="fa fa-check"></i><b>11.2.1</b> Extending to more than one hardcore bit</a></li></ul></li></ul></li><li class="chapter" data-level="12" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>12</b> Lattice based cryptography</a><ul><li><ul><li class="chapter" data-level="12.0.1" data-path=".html"><a href=".html#quick-linear-algebra-recap"><i class="fa fa-check"></i><b>12.0.1</b> Quick linear algebra recap</a></li></ul></li><li class="chapter" data-level="12.1" data-path=".html"><a href=".html#a-world-without-gaussian-elimination"><i class="fa fa-check"></i><b>12.1</b> A world without Gaussian elimination</a></li><li class="chapter" data-level="12.2" data-path=".html"><a href=".html#security-in-the-real-world."><i class="fa fa-check"></i><b>12.2</b> Security in the real world.</a></li><li class="chapter" data-level="12.3" data-path=".html"><a href=".html#search-to-decision"><i class="fa fa-check"></i><b>12.3</b> Search to decision</a></li><li class="chapter" data-level="12.4" data-path=".html"><a href=".html#lweencsec"><i class="fa fa-check"></i><b>12.4</b> An LWE based encryption scheme</a></li><li class="chapter" data-level="12.5" data-path=".html"><a href=".html#but-what-are-lattices"><i class="fa fa-check"></i><b>12.5</b> But what are lattices?</a></li><li class="chapter" data-level="12.6" data-path=".html"><a href=".html#ring-based-lattices"><i class="fa fa-check"></i><b>12.6</b> Ring based lattices</a></li></ul></li><li class="chapter" data-level="13" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>13</b> Chosen ciphertext security for public key encryption</a></li><li class="chapter" data-level="14" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>14</b> Establishing secure connections over insecure channels</a><ul><li class="chapter" data-level="14.1" data-path=".html"><a href=".html#cryptographys-obsession-with-adjectives."><i class="fa fa-check"></i><b>14.1</b> Cryptography’s obsession with adjectives.</a></li><li class="chapter" data-level="14.2" data-path=".html"><a href=".html#basic-key-exchange-protocol"><i class="fa fa-check"></i><b>14.2</b> Basic Key Exchange protocol</a></li><li class="chapter" data-level="14.3" data-path=".html"><a href=".html#authenticated-key-exchange"><i class="fa fa-check"></i><b>14.3</b> Authenticated key exchange</a><ul><li class="chapter" data-level="14.3.1" data-path=".html"><a href=".html#bleichenbachers-attack-on-rsa-pkcs-v1.5-and-ssl-v3.0"><i class="fa fa-check"></i><b>14.3.1</b> Bleichenbacher’s attack on RSA PKCS V1.5 and SSL V3.0</a></li></ul></li><li class="chapter" data-level="14.4" data-path=".html"><a href=".html#chosen-ciphertext-attack-security-for-public-key-cryptography"><i class="fa fa-check"></i><b>14.4</b> Chosen ciphertext attack security for public key cryptography</a></li><li class="chapter" data-level="14.5" data-path=".html"><a href=".html#cca-secure-public-key-encryption-in-the-random-oracle-model"><i class="fa fa-check"></i><b>14.5</b> CCA secure public key encryption in the Random Oracle Model</a><ul><li class="chapter" data-level="14.5.1" data-path=".html"><a href=".html#defining-secure-authenticated-key-exchange"><i class="fa fa-check"></i><b>14.5.1</b> Defining secure authenticated key exchange</a></li><li class="chapter" data-level="14.5.2" data-path=".html"><a href=".html#the-compiler-approach-for-authenticated-key-exchange"><i class="fa fa-check"></i><b>14.5.2</b> The compiler approach for authenticated key exchange</a></li></ul></li><li class="chapter" data-level="14.6" data-path=".html"><a href=".html#password-authenticated-key-exchange."><i class="fa fa-check"></i><b>14.6</b> Password authenticated key exchange.</a></li><li class="chapter" data-level="14.7" data-path=".html"><a href=".html#client-to-client-key-exchange-for-secure-text-messaging---zrtp-otr-textsecure"><i class="fa fa-check"></i><b>14.7</b> Client to client key exchange for secure text messaging - ZRTP, OTR, TextSecure</a></li><li class="chapter" data-level="14.8" data-path=".html"><a href=".html#heartbleed-and-logjam-attacks"><i class="fa fa-check"></i><b>14.8</b> Heartbleed and logjam attacks</a></li></ul></li><li class="chapter" data-level="15" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>15</b> Zero knowledge proofs</a><ul><li class="chapter" data-level="15.1" data-path=".html"><a href=".html#applications-for-zero-knowledge-proofs."><i class="fa fa-check"></i><b>15.1</b> Applications for zero knowledge proofs.</a><ul><li class="chapter" data-level="15.1.1" data-path=".html"><a href=".html#nuclear-disarmament"><i class="fa fa-check"></i><b>15.1.1</b> Nuclear disarmament</a></li><li class="chapter" data-level="15.1.2" data-path=".html"><a href=".html#voting"><i class="fa fa-check"></i><b>15.1.2</b> Voting</a></li><li class="chapter" data-level="15.1.3" data-path=".html"><a href=".html#more-applications"><i class="fa fa-check"></i><b>15.1.3</b> More applications</a></li></ul></li><li class="chapter" data-level="15.2" data-path=".html"><a href=".html#defining-and-constructing-zero-knowledge-proofs"><i class="fa fa-check"></i><b>15.2</b> Defining and constructing zero knowledge proofs</a></li><li class="chapter" data-level="15.3" data-path=".html"><a href=".html#defining-zero-knowledge"><i class="fa fa-check"></i><b>15.3</b> Defining zero knowledge</a></li><li class="chapter" data-level="15.4" data-path=".html"><a href=".html#zero-knowledge-proof-for-hamiltonicity."><i class="fa fa-check"></i><b>15.4</b> Zero knowledge proof for Hamiltonicity.</a><ul><li class="chapter" data-level="15.4.1" data-path=".html"><a href=".html#why-is-this-interesting"><i class="fa fa-check"></i><b>15.4.1</b> Why is this interesting?</a></li></ul></li><li class="chapter" data-level="15.5" data-path=".html"><a href=".html#parallel-repetition-and-turning-zero-knowledge-proofs-to-signatures."><i class="fa fa-check"></i><b>15.5</b> Parallel repetition and turning zero knowledge proofs to signatures.</a><ul><li class="chapter" data-level="15.5.1" data-path=".html"><a href=".html#bonus-features-of-zero-knowledge"><i class="fa fa-check"></i><b>15.5.1</b> "Bonus features" of zero knowledge</a></li></ul></li></ul></li><li class="chapter" data-level="16" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>16</b> Fully homomorphic encryption: Introduction and bootstrapping</a><ul><li class="chapter" data-level="16.1" data-path=".html"><a href=".html#defining-fully-homomorphic-encryption"><i class="fa fa-check"></i><b>16.1</b> Defining fully homomorphic encryption</a><ul><li class="chapter" data-level="16.1.1" data-path=".html"><a href=".html#another-application-fully-homomorphic-encryption-for-verifying-computation"><i class="fa fa-check"></i><b>16.1.1</b> Another application: fully homomorphic encryption for verifying computation</a></li></ul></li><li class="chapter" data-level="16.2" data-path=".html"><a href=".html#example-an-xor-homomorphic-encryption"><i class="fa fa-check"></i><b>16.2</b> Example: An XOR homomorphic encryption</a><ul><li class="chapter" data-level="16.2.1" data-path=".html"><a href=".html#abstraction-a-trapdoor-pseudorandom-generator."><i class="fa fa-check"></i><b>16.2.1</b> Abstraction: A trapdoor pseudorandom generator.</a></li></ul></li><li class="chapter" data-level="16.3" data-path=".html"><a href=".html#from-linear-homomorphism-to-full-homomorphism"><i class="fa fa-check"></i><b>16.3</b> From linear homomorphism to full homomorphism</a></li><li class="chapter" data-level="16.4" data-path=".html"><a href=".html#bootstrapping-fully-homomorphic-escape-velocity"><i class="fa fa-check"></i><b>16.4</b> Bootstrapping: Fully Homomorphic "escape velocity"</a><ul><li class="chapter" data-level="16.4.1" data-path=".html"><a href=".html#radioactive-legos-analogy"><i class="fa fa-check"></i><b>16.4.1</b> Radioactive legos analogy</a></li><li class="chapter" data-level="16.4.2" data-path=".html"><a href=".html#proving-the-bootstrapping-theorem"><i class="fa fa-check"></i><b>16.4.2</b> Proving the bootstrapping theorem</a></li></ul></li></ul></li><li class="chapter" data-level="17" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>17</b> Fully homomorphic encryption: Construction</a><ul><li class="chapter" data-level="17.1" data-path=".html"><a href=".html#prelude-from-vectors-to-matrices"><i class="fa fa-check"></i><b>17.1</b> Prelude: from vectors to matrices</a></li><li class="chapter" data-level="17.2" data-path=".html"><a href=".html#real-world-partially-homomorphic-encryption"><i class="fa fa-check"></i><b>17.2</b> Real world partially homomorphic encryption</a></li><li class="chapter" data-level="17.3" data-path=".html"><a href=".html#noise-management-via-encoding"><i class="fa fa-check"></i><b>17.3</b> Noise management via encoding</a></li><li class="chapter" data-level="17.4" data-path=".html"><a href=".html#putting-it-all-together"><i class="fa fa-check"></i><b>17.4</b> Putting it all together</a></li><li class="chapter" data-level="17.5" data-path=".html"><a href=".html#analysis-of-our-scheme"><i class="fa fa-check"></i><b>17.5</b> Analysis of our scheme</a><ul><li class="chapter" data-level="17.5.1" data-path=".html"><a href=".html#correctness"><i class="fa fa-check"></i><b>17.5.1</b> Correctness</a></li><li class="chapter" data-level="17.5.2" data-path=".html"><a href=".html#cpa-security"><i class="fa fa-check"></i><b>17.5.2</b> CPA Security</a></li><li class="chapter" data-level="17.5.3" data-path=".html"><a href=".html#homomorphism"><i class="fa fa-check"></i><b>17.5.3</b> Homomorphism</a></li><li class="chapter" data-level="17.5.4" data-path=".html"><a href=".html#shallow-decryption-circuit"><i class="fa fa-check"></i><b>17.5.4</b> Shallow decryption circuit</a></li></ul></li><li class="chapter" data-level="17.6" data-path=".html"><a href=".html#advanced-topics"><i class="fa fa-check"></i><b>17.6</b> Advanced topics:</a><ul><li class="chapter" data-level="17.6.1" data-path=".html"><a href=".html#fully-homomorphic-encryption-for-approximate-computation-over-the-real-numbers-ckks"><i class="fa fa-check"></i><b>17.6.1</b> Fully homomorphic encryption for approximate computation over the real numbers: CKKS</a></li><li class="chapter" data-level="17.6.2" data-path=".html"><a href=".html#bandwidth-efficient-fully-homomorphic-encryption-gh"><i class="fa fa-check"></i><b>17.6.2</b> Bandwidth efficient fully homomorphic encryption GH</a></li><li class="chapter" data-level="17.6.3" data-path=".html"><a href=".html#using-fully-homomorphic-encryption-to-achieve-private-information-retrieval."><i class="fa fa-check"></i><b>17.6.3</b> Using fully homomorphic encryption to achieve private information retrieval.</a></li></ul></li></ul></li><li class="chapter" data-level="18" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>18</b> Multiparty secure computation I: Definition and Honest-But-Curious to Malicious complier</a><ul><li class="chapter" data-level="18.1" data-path=".html"><a href=".html#ideal-vs.-real-model-security."><i class="fa fa-check"></i><b>18.1</b> Ideal vs. Real Model Security.</a></li><li class="chapter" data-level="18.2" data-path=".html"><a href=".html#formally-defining-secure-multiparty-computation"><i class="fa fa-check"></i><b>18.2</b> Formally defining secure multiparty computation</a><ul><li class="chapter" data-level="18.2.1" data-path=".html"><a href=".html#first-attempt-a-slightly-too-ideal-definition"><i class="fa fa-check"></i><b>18.2.1</b> First attempt: a slightly "too ideal" definition</a></li><li class="chapter" data-level="18.2.2" data-path=".html"><a href=".html#allowing-for-aborts"><i class="fa fa-check"></i><b>18.2.2</b> Allowing for aborts</a></li><li class="chapter" data-level="18.2.3" data-path=".html"><a href=".html#some-comments"><i class="fa fa-check"></i><b>18.2.3</b> Some comments:</a></li></ul></li><li class="chapter" data-level="18.3" data-path=".html"><a href=".html#example-second-price-auction-using-bitcoin"><i class="fa fa-check"></i><b>18.3</b> Example: Second price auction using bitcoin</a><ul><li class="chapter" data-level="18.3.1" data-path=".html"><a href=".html#another-example-distributed-and-threshold-cryptography"><i class="fa fa-check"></i><b>18.3.1</b> Another example: distributed and threshold cryptography</a></li></ul></li><li class="chapter" data-level="18.4" data-path=".html"><a href=".html#proving-the-fundamental-theorem"><i class="fa fa-check"></i><b>18.4</b> Proving the fundamental theorem:</a></li><li class="chapter" data-level="18.5" data-path=".html"><a href=".html#hbctomalred"><i class="fa fa-check"></i><b>18.5</b> Malicious to honest but curious reduction</a><ul><li class="chapter" data-level="18.5.1" data-path=".html"><a href=".html#handling-probabilistic-strategies"><i class="fa fa-check"></i><b>18.5.1</b> Handling probabilistic strategies:</a></li></ul></li></ul></li><li class="chapter" data-level="19" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>19</b> Multiparty secure computation II: Construction using Fully Homomorphic Encryption</a><ul><li class="chapter" data-level="19.1" data-path=".html"><a href=".html#constructing-2-party-honest-but-curious-computation-from-fully-homomorphic-encryption"><i class="fa fa-check"></i><b>19.1</b> Constructing 2 party honest but curious computation from fully homomorphic encryption</a></li><li class="chapter" data-level="19.2" data-path=".html"><a href=".html#achieving-circuit-privacy-in-a-fully-homomorphic-encryption"><i class="fa fa-check"></i><b>19.2</b> Achieving circuit privacy in a fully homomorphic encryption</a><ul><li class="chapter" data-level="19.2.1" data-path=".html"><a href=".html#bottom-line-a-two-party-secure-computation-protocol"><i class="fa fa-check"></i><b>19.2.1</b> Bottom line: A two party secure computation protocol</a></li></ul></li><li class="chapter" data-level="19.3" data-path=".html"><a href=".html#beyond-two-parties"><i class="fa fa-check"></i><b>19.3</b> Beyond two parties</a></li></ul></li><li class="chapter" data-level="20" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>20</b> Quantum computing and cryptography I</a><ul><li><ul><li class="chapter" data-level="20.0.1" data-path=".html"><a href=".html#quantum-computing-and-computation---an-executive-summary."><i class="fa fa-check"></i><b>20.0.1</b> Quantum computing and computation - an executive summary.</a></li></ul></li><li class="chapter" data-level="20.1" data-path=".html"><a href=".html#quantum-101"><i class="fa fa-check"></i><b>20.1</b> Quantum 101</a><ul><li class="chapter" data-level="20.1.1" data-path=".html"><a href=".html#physically-realizing-quantum-computation"><i class="fa fa-check"></i><b>20.1.1</b> Physically realizing quantum computation</a></li><li class="chapter" data-level="20.1.2" data-path=".html"><a href=".html#bra-ket-notation"><i class="fa fa-check"></i><b>20.1.2</b> Bra-ket notation</a></li><li class="chapter" data-level="20.1.3" data-path=".html"><a href=".html#bells-inequality"><i class="fa fa-check"></i><b>20.1.3</b> Bell’s Inequality</a></li></ul></li><li class="chapter" data-level="20.2" data-path=".html"><a href=".html#grovers-algorithm"><i class="fa fa-check"></i><b>20.2</b> Grover’s Algorithm</a></li></ul></li><li class="chapter" data-level="21" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>21</b> Quantum computing and cryptography II</a><ul><li class="chapter" data-level="21.1" data-path=".html"><a href=".html#from-order-finding-to-factoring-and-discrete-log"><i class="fa fa-check"></i><b>21.1</b> From order finding to factoring and discrete log</a></li><li class="chapter" data-level="21.2" data-path=".html"><a href=".html#finding-periods-of-a-function-simons-algorithm"><i class="fa fa-check"></i><b>21.2</b> Finding periods of a function: Simon’s Algorithm</a></li><li class="chapter" data-level="21.3" data-path=".html"><a href=".html#from-simon-to-shor"><i class="fa fa-check"></i><b>21.3</b> From Simon to Shor</a><ul><li class="chapter" data-level="21.3.1" data-path=".html"><a href=".html#the-fourier-transform-over-z_m"><i class="fa fa-check"></i><b>21.3.1</b> The Fourier transform over \Z_m</a><ul><li class="chapter" data-level="21.3.1.1" data-path=".html"><a href=".html#fast-fourier-transform."><i class="fa fa-check"></i><b>21.3.1.1</b> Fast Fourier Transform.</a></li></ul></li><li class="chapter" data-level="21.3.2" data-path=".html"><a href=".html#quantum-fourier-transform-over-z_m"><i class="fa fa-check"></i><b>21.3.2</b> Quantum Fourier Transform over \Z_m</a></li></ul></li><li class="chapter" data-level="21.4" data-path=".html"><a href=".html#shors-order-finding-algorithm."><i class="fa fa-check"></i><b>21.4</b> Shor’s Order-Finding Algorithm.</a><ul><li class="chapter" data-level="21.4.1" data-path=".html"><a href=".html#analysis-the-case-that-rm"><i class="fa fa-check"></i><b>21.4.1</b> Analysis: the case that r|m</a><ul><li class="chapter" data-level="21.4.1.1" data-path=".html"><a href=".html#the-general-case"><i class="fa fa-check"></i><b>21.4.1.1</b> The general case</a></li></ul></li></ul></li><li class="chapter" data-level="21.5" data-path=".html"><a href=".html#rational-approximation-of-real-numbers"><i class="fa fa-check"></i><b>21.5</b> Rational approximation of real numbers</a><ul><li class="chapter" data-level="21.5.1" data-path=".html"><a href=".html#quantum-cryptography"><i class="fa fa-check"></i><b>21.5.1</b> Quantum cryptography</a></li></ul></li></ul></li><li class="chapter" data-level="22" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>22</b> Software Obfuscation</a><ul><li class="chapter" data-level="22.1" data-path=".html"><a href=".html#witness-encryption"><i class="fa fa-check"></i><b>22.1</b> Witness encryption</a></li><li class="chapter" data-level="22.2" data-path=".html"><a href=".html#deniable-encryption"><i class="fa fa-check"></i><b>22.2</b> Deniable encryption</a></li><li class="chapter" data-level="22.3" data-path=".html"><a href=".html#functional-encryption"><i class="fa fa-check"></i><b>22.3</b> Functional encryption</a></li><li class="chapter" data-level="22.4" data-path=".html"><a href=".html#the-software-patch-problem"><i class="fa fa-check"></i><b>22.4</b> The software patch problem</a></li><li class="chapter" data-level="22.5" data-path=".html"><a href=".html#software-obfuscation-1"><i class="fa fa-check"></i><b>22.5</b> Software obfuscation</a></li><li class="chapter" data-level="22.6" data-path=".html"><a href=".html#applications-of-obfuscation"><i class="fa fa-check"></i><b>22.6</b> Applications of obfuscation</a></li><li class="chapter" data-level="22.7" data-path=".html"><a href=".html#impossibility-of-obfuscation"><i class="fa fa-check"></i><b>22.7</b> Impossibility of obfuscation</a><ul><li class="chapter" data-level="22.7.1" data-path=".html"><a href=".html#proof-of-impossibility-of-vbb-obfuscation"><i class="fa fa-check"></i><b>22.7.1</b> Proof of impossibility of VBB obfuscation</a></li></ul></li><li class="chapter" data-level="22.8" data-path=".html"><a href=".html#indistinguishability-obfuscation"><i class="fa fa-check"></i><b>22.8</b> Indistinguishability obfuscation</a></li></ul></li><li class="chapter" data-level="23" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>23</b> More obfuscation, exotic encryptions</a><ul><li class="chapter" data-level="23.1" data-path=".html"><a href=".html#slower-weaker-less-securer"><i class="fa fa-check"></i><b>23.1</b> Slower, weaker, less securer</a></li><li class="chapter" data-level="23.2" data-path=".html"><a href=".html#how-to-get-ibe-from-pairing-based-assumptions."><i class="fa fa-check"></i><b>23.2</b> How to get IBE from pairing based assumptions.</a></li><li class="chapter" data-level="23.3" data-path=".html"><a href=".html#beyond-pairing-based-cryptography"><i class="fa fa-check"></i><b>23.3</b> Beyond pairing based cryptography</a></li></ul></li><li class="chapter" data-level="24" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>24</b> Anonymous communication</a><ul><li class="chapter" data-level="24.1" data-path=".html"><a href=".html#steganography"><i class="fa fa-check"></i><b>24.1</b> Steganography</a></li><li class="chapter" data-level="24.2" data-path=".html"><a href=".html#anonymous-routing"><i class="fa fa-check"></i><b>24.2</b> Anonymous routing</a></li><li class="chapter" data-level="24.3" data-path=".html"><a href=".html#tor"><i class="fa fa-check"></i><b>24.3</b> Tor</a></li><li class="chapter" data-level="24.4" data-path=".html"><a href=".html#telex"><i class="fa fa-check"></i><b>24.4</b> Telex</a></li><li class="chapter" data-level="24.5" data-path=".html"><a href=".html#riposte"><i class="fa fa-check"></i><b>24.5</b> Riposte</a></li></ul></li><li class="chapter" data-level="25" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>25</b> Ethical, moral, and policy dimensions to cryptography</a><ul><li class="chapter" data-level="25.1" data-path=".html"><a href=".html#reading-prior-to-lecture"><i class="fa fa-check"></i><b>25.1</b> Reading prior to lecture:</a></li><li class="chapter" data-level="25.2" data-path=".html"><a href=".html#case-studies."><i class="fa fa-check"></i><b>25.2</b> Case studies.</a><ul><li class="chapter" data-level="25.2.1" data-path=".html"><a href=".html#the-snowden-revelations"><i class="fa fa-check"></i><b>25.2.1</b> The Snowden revelations</a></li><li class="chapter" data-level="25.2.2" data-path=".html"><a href=".html#fbi-vs-apple-case"><i class="fa fa-check"></i><b>25.2.2</b> FBI vs Apple case</a></li><li class="chapter" data-level="25.2.3" data-path=".html"><a href=".html#juniper-backdoor-case-and-the-opm-break-in"><i class="fa fa-check"></i><b>25.2.3</b> Juniper backdoor case and the OPM break-in</a></li></ul></li></ul></li><li class="chapter" data-level="26" data-path=".html"><a href=".html"><i class="fa fa-check"></i><b>26</b> Course recap</a><ul><li class="chapter" data-level="26.1" data-path=".html"><a href=".html#some-things-we-did-not-cover"><i class="fa fa-check"></i><b>26.1</b> Some things we did not cover</a></li><li class="chapter" data-level="26.2" data-path=".html"><a href=".html#what-i-hope-you-learned"><i class="fa fa-check"></i><b>26.2</b> What I hope you learned</a></li></ul></li><li class="divider"></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-header" role="navigation">
      <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
      </h1>
    </div>

    <div class="book-body">
      <div class="body-inner">


        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->

<div  class="section level2">

<!-- link to pdf version -->


<!-- start of header referring to comments -->
<div><p></p><p style="color:#871640;"><i class="fas fa-wrench"></i> See any bugs/typos/confusing explanations? <a href="https://github.com/boazbk/crypto/issues/new">Open a GitHub issue</a>. You can also <a href="#commentform">comment below</a> <i class="fas fa-wrench"></i></p></div>



<div><p style="color:#871640;">&#x2605; See also the <a id="pdflink" href='https://files.boazbarak.org/crypto/.pdf'><b>PDF version of this chapter</b></a> (better formatting/references) &#x2605;</p></div>

<!-- end of header referring to comments -->

<!--- start of actual content -->

<h1 data-number="14" id="establishing-secure-connections-over-insecure-channels">Establishing secure connections over insecure channels</h1>
<p>We’ve now compiled all the tools that are needed for the basic goal of cryptography (which is still being subverted quite often) allowing Alice and Bob to exchange messages assuring their integrity and confidentiality over a channel that is observed or controlled by an adversary. Our tools for achieving this goal are:</p>
<ul>
<li><p>Public key (aka asymmetric) encryption schemes.</p></li>
<li><p>Public key (aka asymmetric) digital signatures schemes.</p></li>
<li><p>Private key (aka symmetric) encryption schemes - block ciphers and stream ciphers.</p></li>
<li><p>Private key (aka symmetric) message authentication codes and pseudorandom functions.</p></li>
<li><p>Hash functions that are used both as ways to compress messages for authentication as well as key derivation and other tasks.</p></li>
</ul>
<p>The notions of security we require from these building blocks can vary as well. For encryption schemes we talk about CPA (chosen plaintext attack) and CCA (chosen ciphertext attacks), for hash functions we talk about collision-resistance, being used (combined with keys) as pseudorandom functions, and then sometimes we simply model those as random oracles. Also, all of those tools require access to a source of randomness, and here we use hash functions as well for entropy extraction.</p>
<h2 data-number="14.1" id="cryptographys-obsession-with-adjectives.">Cryptography’s obsession with adjectives.</h2>
<p>As we learn more and more cryptography we see more and more adjectives, every notion seems to have modifiers such as “non-malleable”, “leakage-resilient”, “identity based”, “concurrently secure”, “adaptive”, “non-interactive”, etc.. etc… . Indeed, this motivated a parody web page of an <a href="https://cseweb.ucsd.edu/~mihir/crypto-topic-generator.html">automatic crypto paper title generator</a>. Unlike algorithms, where typically there are straightforward <em>quantitative</em> tradeoffs (e.g., faster is better), in cryptography there are many <em>qualitative</em> ways protocols can vary based on the assumptions they operate under and the notions of security they provide.</p>
<p>In particular, the following issues arise when considering the task of securely transmitting information between two parties Alice and Bob:</p>
<ul>
<li><p><strong>Infrastructure/setup assumptions:</strong> What kind of setup can Alice and Bob rely upon? For example in the TLS protocol, typically Alice is a website and Bob is user; Using the infrastructure of certificate authorities, Bob has a trusted way to obtain Alice’s <em>public signature key</em>, while Alice doesn’t know anything about Bob. But there are many other variants as well. Alice and Bob could share a (low entropy) <em>password</em>. One of them might have some hardware token, or they might have a secure out of band channel (e.g., text messages) to transmit a short amount of information. There are even variants where the parties authenticate by something they <em>know</em>, with one recent example being the notion of <em>witness encryption</em> (Garg, Gentry, Sahai, and Waters) where one can encrypt information in a “digital time capsule” to be opened by anyone who, for example, finds a proof of the Riemann hypothesis.</p></li>
<li><p><strong>Adversary access:</strong> What kind of attacks do we need to protect against. The simplest setting is a <em>passive</em> eavesdropping adversary (often called “Eve”) but we sometimes consider an <em>active person-in-the-middle</em> attacks (sometimes called “Mallory”). We sometimes consider notions of <em>graceful recovery</em>. For example, if the adversary manages to hack into one of the parties then it can clearly read their communications from that time onwards, but we would want their past communication to be protected (a notion known as <em>forward secrecy</em>). If we rely on trusted infrastructure such as certificate authorities, we could ask what happens if the adversary breaks into those. Sometimes we rely on the security of several entities or secrets, and we want to consider adversaries that control <em>some</em> but not <em>all</em> of them, a notion known as <em>threshold cryptography</em>.</p></li>
<li><p><strong>Interaction:</strong> Do Alice and Bob get to interact and relay several messages back and forth or is it a “one shot” protocol? You may think that this is merely a question about efficiency but it turns out to be crucial for some applications. Sometimes Alice and Bob might not be two parties separated in space but the same party separated in time. That is, Alice wishes to send a message to her future self by storing an encrypted and authenticated version of it on some media. In this case, absent a time machine, back and forth interaction between the two parties is obviously impossible.</p></li>
<li><p><strong>Security goal:</strong> The security goals of a protocol are usually stated in the negative- what does it mean for an adversary to <em>win</em> the security game. We typically want the adversary to learn absolutely no information about the secret beyond what she obviously can. For example, if we use a shared password chosen out of <span><span class="math inline">\(t\)</span></span> possibilities, then we might need to allow the adversary <span><span class="math inline">\(1/t\)</span></span> success probability, but we wouldn’t want her to get anything beyond <span><span class="math inline">\(1/t+negl(n)\)</span></span>. In some settings, the adversary can obviously completely disconnect the communication channel between Alice and Bob, but we want her to be essentially limited to either dropping communication completely or letting it go by unmolested, and not have the ability to modify communication without detection. Then in some settings, such as in the case of steganography and anonymous routing, we would want the adversary not to find out even the fact that a conversation had taken place.</p></li>
</ul>
<h2 data-number="14.2" id="basic-key-exchange-protocol">Basic Key Exchange protocol</h2>
<p>The basic primitive for secure communication is a <em>key exchange</em> protocol, whose goal is to have Alice and Bob share a common random secret key <span><span class="math inline">\(k\in\{0,1\}^n\)</span></span>. Once this is done, they can use a CCA secure / authenticated private-key encryption to communicate with confidentiality and integrity.</p>
<p>The canonical example of a basic key exchange protocol is the <em>Diffie Hellman</em> protocol. It uses as public parameters a group <span><span class="math inline">\(\mathbb{G}\)</span></span> with generator <span><span class="math inline">\(g\)</span></span>, and then follows the following steps:</p>
<ol type="1">
<li><p>Alice picks random <span><span class="math inline">\(a\leftarrow_R\{0,\ldots,|\mathbb{G}|-1\}\)</span></span> and sends <span><span class="math inline">\(A=g^a\)</span></span>.</p></li>
<li><p>Bob picks random <span><span class="math inline">\(b\leftarrow_R \{0,\ldots,|\mathbb{G}|-1\}\)</span></span> and sends <span><span class="math inline">\(B=g^b\)</span></span>.</p></li>
<li><p>They both set their key as <span><span class="math inline">\(k=H(g^{ab})\)</span></span> (which Alice computes as <span><span class="math inline">\(B^a\)</span></span> and Bob computes as <span><span class="math inline">\(A^b\)</span></span>), where <span><span class="math inline">\(H\)</span></span> is some hash function.</p></li>
</ol>
<p>Another variant is using an arbitrary public key encryption scheme such as RSA:</p>
<ol type="1">
<li><p>Alice generates keys <span><span class="math inline">\((d,e)\)</span></span> and sends <span><span class="math inline">\(e\)</span></span> to Bob.</p></li>
<li><p>Bob picks random <span><span class="math inline">\(k \leftarrow_R\{0,1\}^m\)</span></span> and sends <span><span class="math inline">\(E_e(k)\)</span></span> to Alice.</p></li>
<li><p>They both set their key to <span><span class="math inline">\(k\)</span></span> (which Alice computes by decrypting Bob’s ciphertext)</p></li>
</ol>
<p>Under plausible assumptions, it can be shown that these protocols secure against a <em>passive</em> eavesdropping adversary Eve. The notion of security here means that, similar to encryption, if after observing the transcript Eve receives with probability <span><span class="math inline">\(1/2\)</span></span> the value of <span><span class="math inline">\(k\)</span></span> and with probability <span><span class="math inline">\(1/2\)</span></span> a random string <span><span class="math inline">\(k&#39;\gets\{0,1\}^n\)</span></span>, then her probability of guessing which is the case would be at most <span><span class="math inline">\(1/2+negl(n)\)</span></span> (where <span><span class="math inline">\(n\)</span></span> can be thought of as <span><span class="math inline">\(\log |\mathbb{G}|\)</span></span> or some other parameter related to the length of bit representation of members in the group).</p>
<h2 data-number="14.3" id="authenticated-key-exchange">Authenticated key exchange</h2>
<p>The main issue with this key exchange protocol is of course that adversaries often are <em>not</em> passive. In particular, an active Eve could agree on her own key with Alice and Bob separately and then be able to see and modify all future communication. She might also be able to create weird (with some potential security implications) correlations by, say, modifying the message <span><span class="math inline">\(A\)</span></span> to be <span><span class="math inline">\(A^2\)</span></span> etc..</p>
<p>For this reason, in actual applications we typically use <em>authenticated</em> key exchange. The notion of authentication used depends on what we can assume on the setup assumptions. A standard assumption is that Alice has some public keys but Bob doesn’t. (This is the case when Alice is a website and Bob is a user.) However, one needs to take care in how to use this assumption. Indeed, the standard protocol for securing the web: the <a href="https://goo.gl/md9Bsa">transport Layer Security (TLS) protocol</a> (and its predecessor SSL) has gone through six revisions (including a name change from SSL to TLS) largely because of security concerns. We now illustrate one of those attacks.</p>
<h3 data-number="14.3.1" id="bleichenbachers-attack-on-rsa-pkcs-v1.5-and-ssl-v3.0">Bleichenbacher’s attack on RSA PKCS V1.5 and SSL V3.0</h3>
<p>If you have a public key, a natural approach is to take the encryption-based protocol and simply skip the first step since Bob already knows the public key <span><span class="math inline">\(e\)</span></span> of Alice. This is basically what happened in the SSL V3.0 protocol. However, as was <a href="http://archiv.infsec.ethz.ch/education/fs08/secsem/bleichenbacher98.pdf">shown by Bleichenbacher in 1998</a>, it turns out this is susceptible to the following attack:</p>
<ul>
<li><p>The adversary listens in on a conversation, and in particular observes <span><span class="math inline">\(c=E_e(k)\)</span></span> where <span><span class="math inline">\(k\)</span></span> is the private key.</p></li>
<li><p>The adversary then starts many connections with the server with ciphertexts related to <span><span class="math inline">\(c\)</span></span>, and observes whether they succeed or fail (and in what way they fail, if they do). It turns out that based on this information, the adversary would be able to recover the key <span><span class="math inline">\(k\)</span></span>.</p></li>
</ul>
<p>Specifically, the version of RSA (known as PKCS <span><span class="math inline">\(\sharp\)</span></span> V1.5) used in the SSL V3.0 protocol requires the value <span><span class="math inline">\(x\)</span></span> to have a particular format, with the top two bytes having a certain form. If in the course of the protocol, a server decrypts <span><span class="math inline">\(y\)</span></span> and gets a value <span><span class="math inline">\(x\)</span></span> not of this form then it would send an error message and halt the connection. While the designers of SSL V3.0 might not have thought of it that way, this amounts to saying that an SSL V3.0 server supplies to any party an oracle that on input <span><span class="math inline">\(y\)</span></span> outputs <span><span class="math inline">\(1\)</span></span> iff <span><span class="math inline">\(y^{d} \pmod{m}\)</span></span> has this form, where <span><span class="math inline">\(d = e^{-1} \pmod|\Z^*_m|\)</span></span> is the secret decryption key. It turned out that one can use such an oracle to invert the RSA function. For a result of a similar flavor, see the (1/2 page) proof of Theorem 11.31 (page 418) in KL, where they show that an oracle that given <span><span class="math inline">\(y\)</span></span> outputs the least significant bit of <span><span class="math inline">\(y^d \pmod{m}\)</span></span> allows to invert the RSA function.<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></p>
<p>For this reason, new versions of the SSL used a different variant of RSA known as PKCS $$1 V2.0 which satisfies (under assumptions) <em>chosen ciphertext security (CCA)</em> and in particular such oracles cannot be used to break the encryption. (Nonetheless, there are still some implementation issues that allowed to perform some attacks, see the note in KL page 425 on Manfer’s attack.)</p>
<h2 data-number="14.4" id="chosen-ciphertext-attack-security-for-public-key-cryptography">Chosen ciphertext attack security for public key cryptography</h2>
<p>The concept of chosen ciphertext attack security makes perfect sense for <em>public key</em> encryption as well. It is defined in the same way as it was in the private key setting:</p>
<div id="CCSpubdef" class="definition" title="CCA secure public key encryption" data-number="14.4" name="Definition 14.1 (CCA secure public key encryption) ">
<p>A public key encryption scheme <span><span class="math inline">\((G,E,D)\)</span></span> is <em>chosen ciphertext attack (CCA) secure</em> if every efficient Mallory wins in the following game with probability at most <span><span class="math inline">\(1/2+ negl(n)\)</span></span>:</p>
<ul>
<li><p>The keys <span><span class="math inline">\((e,d)\)</span></span> are generated via <span><span class="math inline">\(G(1^n)\)</span></span>, and Mallory gets the public encryption key <span><span class="math inline">\(e\)</span></span> and <span><span class="math inline">\(1^n\)</span></span>.</p></li>
<li><p>For <span><span class="math inline">\(poly(n)\)</span></span> rounds, Mallory gets access to the function <span><span class="math inline">\(c \mapsto D_d(c)\)</span></span>. (She doesn’t need access to <span><span class="math inline">\(m \mapsto E_e(m)\)</span></span> since she already knows <span><span class="math inline">\(e\)</span></span>.)</p></li>
<li><p>Mallory chooses a pair of messages <span><span class="math inline">\(\{ m_0,m_1 \}\)</span></span>, a secret <span><span class="math inline">\(b\)</span></span> is chosen at random in <span><span class="math inline">\(\{0,1\}\)</span></span>, and Mallory gets <span><span class="math inline">\(c^* = E_e(m_b)\)</span></span>. (Note that she of course does <em>not</em> get the randomness used to generate this challenge encryption.)</p></li>
<li><p>Mallory now gets another <span><span class="math inline">\(poly(n)\)</span></span> rounds of access to the function <span><span class="math inline">\(c \mapsto D_d(c)\)</span></span> except that she is not allowed to query <span><span class="math inline">\(c^*\)</span></span>.</p></li>
<li><p>Mallory outputs <span><span class="math inline">\(b&#39;\)</span></span> and <em>wins</em> if <span><span class="math inline">\(b&#39;=b\)</span></span>.</p></li>
</ul>
</div>
<p>In the private key setting, we achieved CCA security by combining a CPA-secure private key encryption scheme with a message authenticating code (MAC), where to CCA-encrypt a message <span><span class="math inline">\(m\)</span></span>, we first used the CPA-secure scheme on <span><span class="math inline">\(m\)</span></span> to obtain a ciphertext <span><span class="math inline">\(c\)</span></span>, and then added an authentication tag <span><span class="math inline">\(\tau\)</span></span> by signing <span><span class="math inline">\(c\)</span></span> with the MAC. The decryption algorithm first verified the MAC before decrypting the ciphertext. In the public key setting, one might hope that we could repeat the same construction using a CPA-secure <em>public key</em> encryption and replacing the MAC with <em>digital signatures</em>.</p>
<div id="section" class="pause" data-number="14.4" name="Pause">
<p>Try to think what would be such a construction, and whether there is a fundamental obstacle to combining digital signatures and public key encryption in the same way we combined MACs and private key encryption.</p>
</div>
<p>Alas, as you may have realized, there is a fly in this ointment. In a signature scheme (necessarily) it is the <em>signing key</em> that is <em>secret</em>, and the <em>verification key</em> that is <em>public</em>. But in a public key encryption, the <em>encryption</em> key is <em>public</em>, and hence it makes no sense for it to use a secret signing key. (It’s not hard to see that if you reveal the secret signing key then there is no point in using a signature scheme in the first place.)</p>
<p><strong>Why CCA security matters.</strong> For the reasons above, constructing CCA secure public key encryption is very challenging. But is it worth the trouble? Do we really need this “ultra conservative” notion of security? The answer is <em>yes</em>. Just as we argued for <em>private key</em> encryption, chosen ciphertext security is the notion that gets us as close as possible to designing encryptions that fit the metaphor of <em>secure sealed envelopes</em>. Digital analogies will never be a perfect imitation of physical ones, but such metaphors are what people have in mind when designing cryptographic protocols, which is a hard enough task even when we don’t have to worry about the ability of an adversary to reach inside a sealed envelope and XOR the contents of the note written there with some arbitrary string. Indeed, several practical attacks, including Bleichenbacher’s attack above, exploited exactly this gap between the physical metaphor and the digital realization. For more on this, please see <a href="http://www.shoup.net/papers/expo.pdf">Victor Shoup’s survey</a> where he also describes the Cramer-Shoup encryption scheme which was the first practical public key system to be shown CCA secure without resorting to the random oracle heuristic. (The first definition of CCA security, as well as the first polynomial-time construction, was given in a seminal 1991 work of Dolev, Dwork and Naor.)</p>
<h2 data-number="14.5" id="cca-secure-public-key-encryption-in-the-random-oracle-model">CCA secure public key encryption in the Random Oracle Model</h2>
<p>We now show how to convert any CPA-secure public key encryption scheme to a CCA-secure scheme in the random oracle model (this construction is taken from Fujisaki and Okamoto, CRYPTO 99). In the homework, you will see a somewhat simpler direct construction of a CCA secure scheme from a <em>trapdoor permutation</em>, a variant of which is known as OAEP (which has better ciphertext expansion) has been standardized as PKCS $$1 V2.0 and is used in several protocols. The advantage of a generic construction is that it can be instantiated not just with the RSA and Rabin schemes, but also directly with Diffie-Hellman and Lattice based schemes (though there are direct and more efficient variants for these as well).</p>
<blockquote>
<div class="quote" name="Quote 14.5">
<p><strong>CCA-ROM-ENC Scheme:</strong></p>
<ul>
<li><p><strong>Ingredients:</strong> A public key encryption scheme <span><span class="math inline">\((G&#39;,E&#39;,D&#39;)\)</span></span> and a two hash functions <span><span class="math inline">\(H,H&#39;:\{0,1\}^*\rightarrow\{0,1\}^n\)</span></span> (which we model as independent random oracles<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>)</p></li>
<li><p><strong>Key generation:</strong> We generate keys <span><span class="math inline">\((e,d)=G&#39;(1^n)\)</span></span> for the underlying encryption scheme.</p></li>
<li><p><strong>Encryption:</strong> To encrypt a message <span><span class="math inline">\(m\in\{0,1\}^\ell\)</span></span>, we select randomness <span><span class="math inline">\(r\leftarrow_R\{0,1\}^\ell\)</span></span> for the underlying encryption algorithm <span><span class="math inline">\(E&#39;\)</span></span> and output <span><span class="math inline">\(E&#39;_e(r;H(m\|r))\|(H&#39;(r) \oplus m)\)</span></span>, where by <span><span class="math inline">\(E&#39;_e(m&#39;;r&#39;)\)</span></span> we denote the result of encrypting <span><span class="math inline">\(m&#39;\)</span></span> using the key <span><span class="math inline">\(e\)</span></span> and the randomness <span><span class="math inline">\(r&#39;\)</span></span> (we assume the scheme takes <span><span class="math inline">\(n\)</span></span> bits of randomness as input; otherwise modify the output length of <span><span class="math inline">\(H\)</span></span> accordingly).</p></li>
<li><p><strong>Decryption:</strong> To decrypt a ciphertext <span><span class="math inline">\(c\|y\)</span></span> first let <span><span class="math inline">\(r=D_d(c)\)</span></span>, <span><span class="math inline">\(m=H&#39;(r) \oplus y\)</span></span> and then check that <span><span class="math inline">\(c=E_e(m;H(m\|r))\)</span></span>. If the check fails we output <code>error</code>; otherwise we output <span><span class="math inline">\(m\)</span></span>.</p></li>
</ul>
</div>
</blockquote>
<div id="CCAPKCthm" class="theorem" title="CCA security from random oracles" data-number="14.5" name="Theorem 14.2 (CCA security from random oracles) ">
<p>The above CCA-ROM-ENC scheme is CCA secure.</p>
</div>
<div class="proof" data-ref="CCAPKCthm" name="Proof 14.5">
<p><strong>Note:</strong> The proof here refers to the original scheme in the notes (which was not secure) - should be updated by the scribes to the correct proof as presented in lecture.</p>
<p>Suppose towards a contradiction that there exists an adversary <span><span class="math inline">\(M\)</span></span> that wins the CCA game with probability at least <span><span class="math inline">\(1/2+\epsilon\)</span></span> where <span><span class="math inline">\(\epsilon\)</span></span> is non-negligible. Our aim is to show that the decryption box would be “useless” to <span><span class="math inline">\(M\)</span></span> and hence reduce CCA security to CPA security (which we’ll then derive from the CPA security of the underlying scheme).</p>
<p>Consider the following “box” <span><span class="math inline">\(\hat{D}\)</span></span> that will answer decryption queries <span><span class="math inline">\(c\|y\|z\)</span></span> of the adversary as follows:<br />
* If <span><span class="math inline">\(z\)</span></span> was returned before to the adversary as an answer to <span><span class="math inline">\(H&#39;(m\|r)\)</span></span> for some <span><span class="math inline">\(m,r\)</span></span>, and <span><span class="math inline">\(c=E_e(m\;H(m\|r))\)</span></span> and <span><span class="math inline">\(y=m\oplus r\)</span></span> then return <span><span class="math inline">\(m\)</span></span>.<br />
* Otherwise return <code>error</code></p>
<p><strong>Claim:</strong> The probability that <span><span class="math inline">\(\hat{D}\)</span></span> answers a query differently then <span><span class="math inline">\(D\)</span></span> is negligible.</p>
<p><strong>Proof of claim:</strong> If <span><span class="math inline">\(D\)</span></span> gives a non <code>error</code> response to a query <span><span class="math inline">\(c\|y\|z\)</span></span> then it must be that <span><span class="math inline">\(z=H&#39;(m\|r)\)</span></span> for some <span><span class="math inline">\(m,r\)</span></span> such that <span><span class="math inline">\(y = r\oplus m\)</span></span> and <span><span class="math inline">\(c=E_e(r;H(m\|r))\)</span></span>, in which case <span><span class="math inline">\(D\)</span></span> will return <span><span class="math inline">\(m\)</span></span>. The only way that <span><span class="math inline">\(\hat{D}\)</span></span> will answer this question differently is if <span><span class="math inline">\(z=H&#39;(m\|r)\)</span></span> but the query <span><span class="math inline">\(m\|r\)</span></span> hasn’t been asked before by the adversary. Here there are two options. If this query has never been asked before at all, then by the lazy evaluation principle in this case we can think of <span><span class="math inline">\(H&#39;(m\|r)\)</span></span> as being independently chosen at this point, and the probability it happens to equal <span><span class="math inline">\(z\)</span></span> will be <span><span class="math inline">\(2^{-n}\)</span></span>. If this query was asked by someone apart from the adversary then it could only have been asked by the encryption oracle while producing the challenge ciphertext <span><span class="math inline">\(c^*\|y^*\|z^*\)</span></span>, but since the adversary is not allowed to ask this precise ciphertext, then it must be a ciphertext of the form <span><span class="math inline">\(c\|y\|z^*\)</span></span> where <span><span class="math inline">\((c,y) \neq (c^*,y^*)\)</span></span> and such a ciphertext would get an <code>error</code> response from both oracles. <strong>QED (claim)</strong></p>
<p>Note that we can assume without loss of generality that if <span><span class="math inline">\(m^*\)</span></span> is the challenge message and <span><span class="math inline">\(r^*\)</span></span> is the randomness chosen in this challenge, the adversary never asks the query <span><span class="math inline">\(m^*\|r^*\)</span></span> to the its <span><span class="math inline">\(H\)</span></span> or <span><span class="math inline">\(H&#39;\)</span></span> oracles, since we can modify it so that before making a query <span><span class="math inline">\(m\|r\)</span></span>, it will first check if <span><span class="math inline">\(E_e(m\;r)=c^*\)</span></span> where <span><span class="math inline">\(c^*\|y^*\|z^*\)</span></span> is the challenge ciphertext, and if so use this to win the game.</p>
<p>In other words, if we modified the experiment so the values <span><span class="math inline">\(R^*=H(r^*\|m)\)</span></span> and <span><span class="math inline">\(z^*=H&#39;(m^*\|r^*)\)</span></span> chosen while producing the challenge are simply random strings chosen completely independently of everything else. Now note that our oracle <span><span class="math inline">\(\hat{D}\)</span></span> did <em>not</em> need to use the decryption key <span><span class="math inline">\(d\)</span></span>. So, if the adversary wins the CCA game, then it wins the <em>CPA game</em> for the encryption scheme <span><span class="math inline">\(E_e(m) = E&#39;_e(r;R)\| r \oplus m \| R&#39;\)</span></span> where <span><span class="math inline">\(R\)</span></span> and <span><span class="math inline">\(R&#39;\)</span></span> are simply independent random strings; we leave proving that this scheme is CPA secure as an exercise to the reader.</p>
</div>
<h3 data-number="14.5.1" id="defining-secure-authenticated-key-exchange">Defining secure authenticated key exchange</h3>
<p>The basic goal of secure communication is to set up a <em>secure channel</em> between two parties Alice and Bob. We want to do so over an open network, where messages between Alice and Bob might be read, modified, deleted, or added by the adversary. Moreover, we want Alice and Bob to be sure that they are talking to one another rather than other parties. This raises the question of what is identity and how is it verified. Ultimately, if we want to use identities, then we need to trust some authority that decides which party has which identity. This is typically done via a <em>certificate authority (CA)</em>. This is some trusted authority, whose verification key <span><span class="math inline">\(v_{CA}\)</span></span> is public and known to all parties. Alice proves in some way to the CA that she is indeed Alice, and then generates a pair <span><span class="math inline">\((s_{Alice},v_{Alice})\)</span></span>, and gets from the CA the message <span><span class="math inline">\(\sigma_{Alice}\)</span></span>=“The key <span><span class="math inline">\(v_{Alice}\)</span></span> belongs to Alice” signed with <span><span class="math inline">\(s_{CA}\)</span></span>.<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup> Now Alice can send <span><span class="math inline">\((v_{Alice},\sigma_{Alice})\)</span></span> to Bob to certify that the owner of this public key is indeed Alice.</p>
<p>For example, in the web setting, certain <a href="https://en.wikipedia.org/wiki/Certificate_authority">certificate authorities</a> can certify that a certain public key is associated with a certain website. If you go to a website using the <code>https</code> protocol, you should see a “lock” symbol on your browser which will give you details on the certificate. Often the certificate is a chain of certificate. If I click on this lock symbol in my Chrome browser, I see that the certificate that amazon.com’s public key is some particular string (corresponding to a 2048 RSA modulos and exponent) is signed by the Symantec Certificate authority, whose own key is certified by Verisign. My communication with Amazon is an example of a setting of <em>one sided authentication</em>. It is important for me to know that I am truly talking to amazon.com, while Amazon is willing to talk to any client. (Though of course once we establish a secure channel, I could use it to login to my Amazon account.) Chapter 21 of Boneh Shoup contains an in depth discussion of authenticated key exchange protocols.</p>
<div id="section-1" class="pause" data-number="14.5.1" name="Pause">
<p>You should stop here and read Section 21.9 of Boneh Shoup with the formal definitions of authenticated key exchange, going back as needed to the previous section for the definitions of protocols AEK1 - AEK4.</p>
</div>
<h3 data-number="14.5.2" id="the-compiler-approach-for-authenticated-key-exchange">The compiler approach for authenticated key exchange</h3>
<p>There is a generic “compiler” approach to obtaining authenticated key exchange protocols:</p>
<ul>
<li><p>Start with a protocol such as the basic Diffie-Hellman protocol that is only secure with respect to a <em>passive eavesdropping</em> adversary.</p></li>
<li><p>Then <em>compile</em> it into a protocol that is secure with respect to an active adversary using authentication tools such as digital signatures, message authentication codes, etc.., depending on what kind of setup you can assume and what properties you want to achieve.</p></li>
</ul>
<p>This approach has the advantage of being modular in both the construction and the analysis. However, direct constructions might be more efficient. There are a great many potentially desirable properties of key exchange protocols, and different protocols achieve different subsets of these properties at different costs. The most common variant of authenticated key exchange protocols is to use some version of the Diffie-Hellman key exchange. If both parties have public signature keys, then they can simply sign their messages and then that effectively rules out an active attack, reducing active security to passive security (though one needs to include identities in the signatures to ensure non repeating of messages, see <a href="http://link.springer.com/article/10.1007%2FBF00124891">here</a>).</p>
<p>The most efficient variants of Diffie Hellman achieve authentication implicitly, where the basic protocol remains the same (sending <span><span class="math inline">\(X=g^x\)</span></span> and <span><span class="math inline">\(Y=g^y\)</span></span>) but the computation of the secret shared key involves some authentication information. Of these protocols a particularly efficient variant is the MQV protocol of Law, Menezes, Qu, Solinas and Vanstone (which is based on similar principles as DSA signatures), and its variant <a href="https://eprint.iacr.org/2005/176.pdf">HMQV</a> by Krawczyk that has some improved security properties and analysis.</p>
<h2 data-number="14.6" id="password-authenticated-key-exchange.">Password authenticated key exchange.</h2>
<p>To be completed (the most natural candidate: use MACS with a password-derived key to authenticate communication - completely fails)</p>
<div id="section-2" class="pause" data-number="14.6" name="Pause">
<p>Please skim Boneh Shoup Chapter 21.11</p>
</div>
<h2 data-number="14.7" id="client-to-client-key-exchange-for-secure-text-messaging---zrtp-otr-textsecure">Client to client key exchange for secure text messaging - ZRTP, OTR, TextSecure</h2>
<p>To be completed. See <a href="http://blog.cryptographyengineering.com/2013/03/here-come-encryption-apps.html">Matthew Green’s blog</a> , <a href="https://whispersystems.org/blog/advanced-ratcheting/">text secure</a>, <a href="https://otr.cypherpunks.ca/Protocol-v3-4.0.0.html">OTR</a>.</p>
<p>Security requirements: forward secrecy, deniability.</p>
<h2 data-number="14.8" id="heartbleed-and-logjam-attacks">Heartbleed and logjam attacks</h2>
<ul>
<li><p>Vestiges of past crypto policies.</p></li>
<li><p>Importance of “perfect forward secrecy”</p></li>
</ul>
<figure>
<img src="../figure/NSA_Page_29.jpg" id="tmplabelfig" class="margin" alt="" /><figcaption>21.1: How the NSA feels about breaking encrypted communication</figcaption>
</figure>
<div id="footnotediv" class="footnotes">
<ol>
<li class="footnote" id="fn:1"><p>
<div>
<p>The first attack of this flavor was given in the 1982 paper of Goldwasser, Micali, and Tong. Interestingly, this notion of “hardcore bits” has been used for both practical <em>attacks</em> against cryptosystems as well as theoretical (and sometimes practical) <em>constructions</em> of other cryptosystems.</p>
</div>
<a href="#fnref:1" title="return to article"> ↩</a><p></li>
<li class="footnote" id="fn:2"><p>
<div>
<p>Recall that it’s easy to obtain two independent random oracles <span><span class="math inline">\(H,H&#39;\)</span></span> from a single oracle <span><span class="math inline">\(H&#39;&#39;\)</span></span>, for example by letting <span><span class="math inline">\(H(x)=H&#39;&#39;(0\|x)\)</span></span> and <span><span class="math inline">\(H&#39;(x)=H&#39;&#39;(1\|x)\)</span></span>.</p>
</div>
<a href="#fnref:2" title="return to article"> ↩</a><p></li>
<li class="footnote" id="fn:3"><p>
<div>
<p>The registration process could be more subtle than that, and for example Alice might need to <em>prove</em> to the CA that she does indeed know the corresponding secret key.</p>
</div>
<a href="#fnref:3" title="return to article"> ↩</a><p></li>
</ol>
</div>
<!--bookdown:body:end-->


<!-- end of  actual content -->

<!-- start of comments -->


<a name="commentform"></a>
<h2 id="comments" class="nocount">Comments</h2>

<p>Comments are posted on the <a href="https://github.com/boazbk/crypto/issues">GitHub repository</a> using the <a href="https://utteranc.es">utteranc.es</a> app.
A GitHub login is required to comment.
If you don't want to authorize the app to post on your behalf, you can also comment directly on the <a href="https://github.com/boazbk/crypto/issues?q=+in%3Atitle">GitHub issue for this page</a>.


<p>


<script src="https://utteranc.es/client.js" 
repo="boazbk/crypto" 
issue-term="title" 
label="comments"
theme="github-light" 
crossorigin="anonymous" async>
  </script>


<!-- end of comments -->

<p>Compiled on 07/22/2020 10:34:54</p>

<p>Copyright 2019, Boaz Barak.


<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License"
    style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br />This work is
licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons
  Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.

<p>Produced using <a href="https://pandoc.org/">pandoc</a> and <a href="http://scorreia.com/software/panflute/">panflute</a> with templates derived from <a href="https://www.gitbook.com/">gitbook</a> and <a href="https://bookdown.org/">bookdown</a>.</p>



</div>


            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->



    </div>
  </div>
<!--bookdown:config-->
<script src="js/app.min.js"></script>
<script src="js/lunr.js"></script>
<script src="js/plugin-search.js"></script>
<script src="js/plugin-sharing.js"></script>
<script src="js/plugin-fontsettings.js"></script>
<script src="js/fullscreen.js"></script>
<script src="js/plugin-bookdown.js"></script>
<script src="js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"history": {
"link": null,
"text": null
},
"download": ["https://files.boazbarak.org/crypto/.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>


</body>

</html>
